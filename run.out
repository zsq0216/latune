Using device: gpu
i: 0, metrics: {'tps_avg': np.float64(56.291771059806194), 'pps_avg': np.float64(172.74162805757865), 'cpu_avg': np.float64(0.4166666666666667), 'mem_avg': np.float64(5226.9375), 'gpu_avg': np.float64(2184.0)}
i: 1, metrics: {'tps_avg': np.float64(31.119806238633327), 'pps_avg': np.float64(86.56084775631332), 'cpu_avg': np.float64(22.243636363636366), 'mem_avg': np.float64(5132.386363636364), 'gpu_avg': np.float64(726.0)}
i: 2, metrics: {'tps_avg': np.float64(59.10060119811789), 'pps_avg': np.float64(178.30045797388496), 'cpu_avg': np.float64(0.3733333333333333), 'mem_avg': np.float64(5281.078125), 'gpu_avg': np.float64(1672.5)}
i: 3, metrics: {'tps_avg': np.float64(56.20106816513103), 'pps_avg': np.float64(172.76024151802937), 'cpu_avg': np.float64(0.365), 'mem_avg': np.float64(4857.135416666667), 'gpu_avg': np.float64(2006.1666666666667)}
i: 4, metrics: {'tps_avg': np.float64(31.921657770709842), 'pps_avg': np.float64(155.5060910398024), 'cpu_avg': np.float64(4.9910000000000005), 'mem_avg': np.float64(4801.86875), 'gpu_avg': np.float64(1529.7)}
i: 5, metrics: {'tps_avg': np.float64(33.25219523896486), 'pps_avg': np.float64(47.61148975134527), 'cpu_avg': np.float64(17.299090909090907), 'mem_avg': np.float64(5055.620738636364), 'gpu_avg': np.float64(844.5454545454545)}
i: 6, metrics: {'tps_avg': np.float64(56.17811907468379), 'pps_avg': np.float64(172.90658694911198), 'cpu_avg': np.float64(0.29500000000000004), 'mem_avg': np.float64(4500.90625), 'gpu_avg': np.float64(1541.0)}
i: 7, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(95.52911999999999), 'mem_avg': np.float64(5253.203), 'gpu_avg': np.float64(639.916)}
i: 8, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(96.19004), 'mem_avg': np.float64(5275.1559375), 'gpu_avg': np.float64(1491.188)}
i: 9, metrics: {'tps_avg': np.float64(21.579479623031446), 'pps_avg': np.float64(100.14855737851371), 'cpu_avg': np.float64(38.74675), 'mem_avg': np.float64(4376.135546875), 'gpu_avg': np.float64(2359.4)}
i: 10, metrics: {'tps_avg': np.float64(35.007121079565536), 'pps_avg': np.float64(125.49726850109342), 'cpu_avg': np.float64(2.8680000000000003), 'mem_avg': np.float64(4487.640625), 'gpu_avg': np.float64(1423.9)}
i: 11, metrics: {'tps_avg': np.float64(58.69025640254944), 'pps_avg': np.float64(178.3022136139806), 'cpu_avg': np.float64(0.25333333333333335), 'mem_avg': np.float64(4321.388020833333), 'gpu_avg': np.float64(1418.0)}
i: 12, metrics: {'tps_avg': np.float64(35.32375265872705), 'pps_avg': np.float64(157.63784471351224), 'cpu_avg': np.float64(1.6955555555555557), 'mem_avg': np.float64(5155.552083333333), 'gpu_avg': np.float64(1433.888888888889)}
i: 13, metrics: {'tps_avg': np.float64(30.85732164412761), 'pps_avg': np.float64(145.52370872140634), 'cpu_avg': np.float64(8.671000000000001), 'mem_avg': np.float64(4419.89375), 'gpu_avg': np.float64(1371.1)}
i: 14, metrics: {'tps_avg': np.float64(35.9643968797528), 'pps_avg': np.float64(114.94484854831747), 'cpu_avg': np.float64(14.604444444444445), 'mem_avg': np.float64(4862.762152777777), 'gpu_avg': np.float64(1399.3333333333333)}
i: 15, metrics: {'tps_avg': np.float64(55.69427903532178), 'pps_avg': np.float64(172.64650803170431), 'cpu_avg': np.float64(0.2485714285714286), 'mem_avg': np.float64(4339.861607142857), 'gpu_avg': np.float64(1434.0)}
i: 16, metrics: {'tps_avg': np.float64(48.01580987319064), 'pps_avg': np.float64(67.0091838330319), 'cpu_avg': np.float64(23.7025), 'mem_avg': np.float64(4504.494140625), 'gpu_avg': np.float64(954.375)}
i: 17, metrics: {'tps_avg': np.float64(35.75053001855506), 'pps_avg': np.float64(159.06205273799856), 'cpu_avg': np.float64(1.1744444444444444), 'mem_avg': np.float64(4736.770833333333), 'gpu_avg': np.float64(1481.4444444444443)}
i: 18, metrics: {'tps_avg': np.float64(52.60684637082051), 'pps_avg': np.float64(87.77152330623166), 'cpu_avg': np.float64(66.44142857142857), 'mem_avg': np.float64(5280.183035714285), 'gpu_avg': np.float64(1530.7142857142858)}
i: 19, metrics: {'tps_avg': np.float64(52.90845853990086), 'pps_avg': np.float64(1.8645866242710198), 'cpu_avg': np.float64(90.44295081967213), 'mem_avg': np.float64(4542.2046618852455), 'gpu_avg': np.float64(1400.9180327868853)}
i: 20, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(92.12627049180327), 'mem_avg': np.float64(4641.937115778688), 'gpu_avg': np.float64(1547.7868852459017)}
i: 21, metrics: {'tps_avg': np.float64(55.83833230093023), 'pps_avg': np.float64(168.10010194241053), 'cpu_avg': np.float64(0.3016666666666667), 'mem_avg': np.float64(4359.580729166667), 'gpu_avg': np.float64(1528.0)}
i: 22, metrics: {'tps_avg': np.float64(55.889870656949995), 'pps_avg': np.float64(172.7974370357779), 'cpu_avg': np.float64(0.4016666666666666), 'mem_avg': np.float64(5177.270833333333), 'gpu_avg': np.float64(1703.5)}
i: 23, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(93.73659751037344), 'mem_avg': np.float64(4993.760827282158), 'gpu_avg': np.float64(1536.8921161825726)}
i: 24, metrics: {'tps_avg': np.float64(32.09088772340587), 'pps_avg': np.float64(6.432352954369228), 'cpu_avg': np.float64(61.677307692307686), 'mem_avg': np.float64(4299.3828125), 'gpu_avg': np.float64(1461.0384615384614)}
i: 25, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(93.78572016460906), 'mem_avg': np.float64(4704.642103909465), 'gpu_avg': np.float64(1459.954732510288)}
i: 26, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(95.96744), 'mem_avg': np.float64(4961.2614375), 'gpu_avg': np.float64(640.176)}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
i: 27, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(9.02), 'mem_avg': np.float64(4116.984375), 'gpu_avg': np.float64(1117.0)}
i: 28, metrics: {'tps_avg': np.float64(51.59264302821749), 'pps_avg': np.float64(159.27290899848765), 'cpu_avg': np.float64(0.4357142857142858), 'mem_avg': np.float64(5134.609375), 'gpu_avg': np.float64(2789.714285714286)}
i: 29, metrics: {'tps_avg': np.float64(58.96149243047977), 'pps_avg': np.float64(178.3789572051634), 'cpu_avg': np.float64(0.2833333333333333), 'mem_avg': np.float64(4514.4609375), 'gpu_avg': np.float64(1593.6666666666667)}
i: 30, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(97.14279352226723), 'mem_avg': np.float64(4567.451163967611), 'gpu_avg': np.float64(978.9716599190283)}
i: 31, metrics: {'tps_avg': np.float64(54.22161444063445), 'pps_avg': np.float64(8.443203009239534), 'cpu_avg': np.float64(79.09882352941177), 'mem_avg': np.float64(4703.988051470588), 'gpu_avg': np.float64(1466.1176470588234)}
i: 32, metrics: {'tps_avg': np.float64(57.491246550502304), 'pps_avg': np.float64(45.10733095954046), 'cpu_avg': np.float64(51.792500000000004), 'mem_avg': np.float64(4463.291015625), 'gpu_avg': np.float64(1471.375)}
i: 33, metrics: {'tps_avg': np.float64(54.24447954849538), 'pps_avg': np.float64(103.12804865449066), 'cpu_avg': np.float64(30.93857142857143), 'mem_avg': np.float64(4800.662946428572), 'gpu_avg': np.float64(1230.2857142857142)}
i: 34, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(93.67114754098361), 'mem_avg': np.float64(5226.481877561476), 'gpu_avg': np.float64(1419.766393442623)}
i: 35, metrics: {'tps_avg': np.float64(38.284539165330884), 'pps_avg': np.float64(112.88209841816591), 'cpu_avg': np.float64(0.08581395348837208), 'mem_avg': np.float64(4508.78488372093), 'gpu_avg': np.float64(1555.139534883721)}
i: 36, metrics: {'tps_avg': np.float64(36.04739066427039), 'pps_avg': np.float64(160.26075064013972), 'cpu_avg': np.float64(1.0822222222222224), 'mem_avg': np.float64(4321.131944444444), 'gpu_avg': np.float64(2479.5555555555557)}
i: 37, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(97.49610655737706), 'mem_avg': np.float64(5106.9544697745905), 'gpu_avg': np.float64(1482.2377049180327)}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
i: 38, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(9.02), 'mem_avg': np.float64(4181.78125), 'gpu_avg': np.float64(2294.0)}
i: 39, metrics: {'tps_avg': np.float64(32.708030828525956), 'pps_avg': np.float64(9.35002468715451), 'cpu_avg': np.float64(58.00714285714286), 'mem_avg': np.float64(4355.502232142857), 'gpu_avg': np.float64(2480.3333333333335)}
i: 40, metrics: {'tps_avg': np.float64(35.648308584550186), 'pps_avg': np.float64(7.67441569694414), 'cpu_avg': np.float64(61.63954545454545), 'mem_avg': np.float64(5024.657670454545), 'gpu_avg': np.float64(2563.181818181818)}
i: 41, metrics: {'tps_avg': np.float64(31.83034871868627), 'pps_avg': np.float64(146.34975305246502), 'cpu_avg': np.float64(8.062000000000001), 'mem_avg': np.float64(4954.66875), 'gpu_avg': np.float64(2473.5)}
i: 42, metrics: {'tps_avg': np.float64(47.04753436757363), 'pps_avg': np.float64(10.774256547203558), 'cpu_avg': np.float64(67.35999999999999), 'mem_avg': np.float64(4646.864583333333), 'gpu_avg': np.float64(1962.1333333333334)}
i: 43, metrics: {'tps_avg': np.float64(56.76350391480458), 'pps_avg': np.float64(173.0191391924311), 'cpu_avg': np.float64(0.335), 'mem_avg': np.float64(4720.575520833333), 'gpu_avg': np.float64(1811.8333333333333)}
i: 44, metrics: {'tps_avg': np.float64(34.850000252379466), 'pps_avg': np.float64(18.91443975690869), 'cpu_avg': np.float64(37.138571428571424), 'mem_avg': np.float64(4898.9296875), 'gpu_avg': np.float64(1455.5714285714287)}
i: 45, metrics: {'tps_avg': np.float64(43.002439943498025), 'pps_avg': np.float64(79.49134003706251), 'cpu_avg': np.float64(29.873333333333335), 'mem_avg': np.float64(5127.164930555556), 'gpu_avg': np.float64(2512.5555555555557)}
i: 46, metrics: {'tps_avg': np.float64(35.2961775280752), 'pps_avg': np.float64(148.74337761602715), 'cpu_avg': np.float64(2.852222222222222), 'mem_avg': np.float64(4748.706597222223), 'gpu_avg': np.float64(2891.1111111111113)}
i: 47, metrics: {'tps_avg': np.float64(48.636801574240586), 'pps_avg': np.float64(7.2352373455597165), 'cpu_avg': np.float64(80.328), 'mem_avg': np.float64(4526.53984375), 'gpu_avg': np.float64(1483.1)}
i: 48, metrics: {'tps_avg': np.float64(35.89575217492284), 'pps_avg': np.float64(5.5586163070120405), 'cpu_avg': np.float64(70.24892857142858), 'mem_avg': np.float64(4897.143973214285), 'gpu_avg': np.float64(2571.6785714285716)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 49, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.8699999999999999), 'mem_avg': np.float64(5065.40625), 'gpu_avg': np.float64(2695.0)}
i: 50, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(97.7980081300813), 'mem_avg': np.float64(4963.156631097561), 'gpu_avg': np.float64(1967.8333333333333)}
i: 51, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(96.56214876033059), 'mem_avg': np.float64(4750.323217975207), 'gpu_avg': np.float64(1511.400826446281)}
i: 52, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(96.74338775510205), 'mem_avg': np.float64(4792.041900510204), 'gpu_avg': np.float64(2563.8204081632653)}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
i: 53, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(7.82), 'mem_avg': np.float64(4182.390625), 'gpu_avg': np.float64(2541.0)}
i: 54, metrics: {'tps_avg': np.float64(56.82597932322373), 'pps_avg': np.float64(169.795838558268), 'cpu_avg': np.float64(0.355), 'mem_avg': np.float64(4707.625), 'gpu_avg': np.float64(2973.1666666666665)}
i: 55, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(98.41400809716599), 'mem_avg': np.float64(4954.297760627531), 'gpu_avg': np.float64(1558.412955465587)}
i: 56, metrics: {'tps_avg': np.float64(56.99773629113616), 'pps_avg': np.float64(171.5002313652354), 'cpu_avg': np.float64(0.36166666666666664), 'mem_avg': np.float64(4832.385416666667), 'gpu_avg': np.float64(1932.6666666666667)}
i: 57, metrics: {'tps_avg': np.float64(35.095422351319904), 'pps_avg': np.float64(130.88038107856121), 'cpu_avg': np.float64(4.433333333333334), 'mem_avg': np.float64(5114.149305555556), 'gpu_avg': np.float64(1631.3333333333333)}
i: 58, metrics: {'tps_avg': np.float64(41.61035983812158), 'pps_avg': np.float64(92.36338385488466), 'cpu_avg': np.float64(16.182222222222222), 'mem_avg': np.float64(5126.809027777777), 'gpu_avg': np.float64(1619.3333333333333)}
i: 59, metrics: {'tps_avg': np.float64(56.5517502857798), 'pps_avg': np.float64(169.93852966115793), 'cpu_avg': np.float64(0.36833333333333335), 'mem_avg': np.float64(4605.0703125), 'gpu_avg': np.float64(2894.1666666666665)}
i: 60, metrics: {'tps_avg': np.float64(40.447639140754774), 'pps_avg': np.float64(91.05234353774757), 'cpu_avg': np.float64(28.13111111111111), 'mem_avg': np.float64(4551.220486111111), 'gpu_avg': np.float64(1515.3333333333333)}
i: 61, metrics: {'tps_avg': np.float64(1.4070129478007447), 'pps_avg': np.float64(15.969724063703973), 'cpu_avg': np.float64(89.51541666666667), 'mem_avg': np.float64(5186.126220703125), 'gpu_avg': np.float64(1593.7552083333333)}
i: 62, metrics: {'tps_avg': np.float64(59.642740347249294), 'pps_avg': np.float64(178.17459807464584), 'cpu_avg': np.float64(0.3133333333333333), 'mem_avg': np.float64(4960.34375), 'gpu_avg': np.float64(1671.6666666666667)}
i: 63, metrics: {'tps_avg': np.float64(31.700978322668387), 'pps_avg': np.float64(6.606637266305499), 'cpu_avg': np.float64(64.5024), 'mem_avg': np.float64(4861.55875), 'gpu_avg': np.float64(1520.68)}
i: 64, metrics: {'tps_avg': np.float64(30.571298226557502), 'pps_avg': np.float64(118.06921493588537), 'cpu_avg': np.float64(9.465454545454547), 'mem_avg': np.float64(4847.107954545455), 'gpu_avg': np.float64(2596.0)}
i: 65, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(95.92473251028808), 'mem_avg': np.float64(4337.473894032922), 'gpu_avg': np.float64(2566.0699588477364)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 66, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(0.06397590361445783), 'mem_avg': np.float64(251.38685993975903), 'gpu_avg': np.float64(2670.8192771084337)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 67, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.39), 'mem_avg': np.float64(378.84375), 'gpu_avg': np.float64(2894.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 68, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.45999999999999996), 'mem_avg': np.float64(1207.8125), 'gpu_avg': np.float64(2615.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 69, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.8400000000000001), 'mem_avg': np.float64(5108.9375), 'gpu_avg': np.float64(3094.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 70, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.63), 'mem_avg': np.float64(532.984375), 'gpu_avg': np.float64(2887.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 71, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.22), 'mem_avg': np.float64(5002.265625), 'gpu_avg': np.float64(3012.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 72, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.46), 'mem_avg': np.float64(690.25), 'gpu_avg': np.float64(2782.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 73, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.8), 'mem_avg': np.float64(1415.6875), 'gpu_avg': np.float64(2591.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 74, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.1300000000000001), 'mem_avg': np.float64(4436.34375), 'gpu_avg': np.float64(2657.0)}
i: 75, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(98.29572580645163), 'mem_avg': np.float64(4410.165952620968), 'gpu_avg': np.float64(2587.0403225806454)}
i: 76, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(65.0068699186992), 'mem_avg': np.float64(1617.1417047764228), 'gpu_avg': np.float64(2682.170731707317)}
Request failed: Request failed: 
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
Request failed: Request failed: {"error":{"code":503,"message":"Loading model","type":"unavailable_error"}}
i: 77, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.91), 'mem_avg': np.float64(4178.114583333333), 'gpu_avg': np.float64(2638.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 78, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.9199999999999999), 'mem_avg': np.float64(5040.609375), 'gpu_avg': np.float64(2748.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 79, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(43.17), 'mem_avg': np.float64(4288.4140625), 'gpu_avg': np.float64(2568.5)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 80, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.32999999999999996), 'mem_avg': np.float64(946.59375), 'gpu_avg': np.float64(2760.0)}
i: 81, metrics: {'tps_avg': np.float64(1.0), 'pps_avg': np.float64(1.0), 'cpu_avg': np.float64(98.5910931174089), 'mem_avg': np.float64(4648.06439777328), 'gpu_avg': np.float64(2557.1255060728745)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 82, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.45999999999999996), 'mem_avg': np.float64(4485.6875), 'gpu_avg': np.float64(2595.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 83, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(44.125), 'mem_avg': np.float64(5091.4765625), 'gpu_avg': np.float64(2602.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 84, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.52), 'mem_avg': np.float64(1029.109375), 'gpu_avg': np.float64(2819.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 85, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.23), 'mem_avg': np.float64(439.34375), 'gpu_avg': np.float64(2845.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 86, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.9400000000000001), 'mem_avg': np.float64(5118.90625), 'gpu_avg': np.float64(2869.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 87, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(28.755000000000003), 'mem_avg': np.float64(4483.671875), 'gpu_avg': np.float64(2817.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 88, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.1), 'mem_avg': np.float64(994.015625), 'gpu_avg': np.float64(3006.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 89, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.24), 'mem_avg': np.float64(394.6875), 'gpu_avg': np.float64(2880.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 90, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(40.56), 'mem_avg': np.float64(1384.25), 'gpu_avg': np.float64(3090.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 91, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.96), 'mem_avg': np.float64(820.984375), 'gpu_avg': np.float64(2785.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 92, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.35), 'mem_avg': np.float64(500.328125), 'gpu_avg': np.float64(2866.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 93, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(33.980000000000004), 'mem_avg': np.float64(1676.9921875), 'gpu_avg': np.float64(3129.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 94, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.04), 'mem_avg': np.float64(114.390625), 'gpu_avg': np.float64(2766.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 95, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.0699999999999998), 'mem_avg': np.float64(992.0), 'gpu_avg': np.float64(2970.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 96, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.26), 'mem_avg': np.float64(5088.765625), 'gpu_avg': np.float64(3053.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 97, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(1.52), 'mem_avg': np.float64(801.484375), 'gpu_avg': np.float64(3218.0)}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
Request failed: Request failed: {"error":{"code":500,"message":"Input prompt is too big compared to KV size. Please try increasing KV size.","type":"server_error"}}
i: 98, metrics: {'tps_avg': 0, 'pps_avg': 0, 'cpu_avg': np.float64(0.9400000000000001), 'mem_avg': np.float64(5075.984375), 'gpu_avg': np.float64(3120.0)}
Server startup timed out
Traceback (most recent call last):
  File "/Users/cz/work/scripts/llama_executor.py", line 167, in _start_server_and_metrics_thread
    self.server_process = self._run_llama_server(config = config, model_path = model_path)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cz/work/scripts/llama_executor.py", line 341, in _run_llama_server
    self._wait_for_server_ready(config.get("port", 8080), timeout=30)
  File "/Users/cz/work/scripts/llama_executor.py", line 480, in _wait_for_server_ready
    raise TimeoutError("Server startup timed out")
TimeoutError: Server startup timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/cz/work/scripts/01_knobs_ranking.py", line 264, in <module>
    X, y = optimizer.generate_dataset(n_samples=100)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cz/work/scripts/01_knobs_ranking.py", line 42, in generate_dataset
    metrics = self.evaluate_config(config.to_dict())
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cz/work/scripts/01_knobs_ranking.py", line 34, in evaluate_config
    return self.executor.run_server_performance_test(config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cz/work/scripts/llama_executor.py", line 260, in run_server_performance_test
    thread, metrics = self._start_server_and_metrics_thread(config, model_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cz/work/scripts/llama_executor.py", line 170, in _start_server_and_metrics_thread
    raise ValueError(e)
ValueError: Server startup timed out
